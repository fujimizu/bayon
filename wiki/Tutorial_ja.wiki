_Tutorial for Bayon in Japanese_

<wiki:toc />

= はじめに =

Bayonは汎用的に利用できる[http://ja.wikipedia.org/wiki/データ・クラスタリング データクラスタリング]ツールで、現在は Repeated Bisection法 と [http://ja.wikipedia.org/wiki/K-means%E6%B3%95 K-means法] に対応しています。

シンプルな構成で、かつ大規模なデータに対しても高速に実行できるところが特徴です。大量のデータを俯瞰したいときに、似た者同士のグループにサクッと分けて確認する、といったユースケースに利用できます。

= 更新情報 =

 * 2009/06/05: 0.0.1リリース

= ダウンロード =

[http://code.google.com/p/bayon/downloads/list 最新版のソースコード]をダウンロードしてください。

= インストール =

最新のソースコードをダウンロードして、以下のようにしてインストールしてください。make testを実行する場合は [http://code.google.com/p/googletest/ googletest] が必要となるため、事前にgoogletestをインストールしておいてください。

{{{
% tar xvzf bayon-*.tar.gz
% cd bayon-*
% ./configure
% make
% make test  (googletest をインストールしておく必要があります)
% sudo make install
}}}

= 使い方 =

== コマンドラインツール ==

コマンドラインツールを使用する際は、以下のオプションを指定して実行してください。クラスタリング結果は標準出力に出力されます。

{{{
% bayon -n num [-m method] file
% bayon -l limit [-m method] file
     -n, --number num    ... 分割するクラスタの数
     -l, --limit lim     ... 分割ポイントの閾値
     -m, --method method ... クラスタリング手法(rb, kmeans), デフォルトはrb
}}}

=== クラスタ数を指定して実行する場合 ===

出力するクラスタの数を指定する場合は以下のようにして実行してください。

{{{
% bayon -n 100 input.tsv > output.tsv (100個のクラスタに分割する場合)
}}}

=== 分割ポイントを指定して実行する場合 ===

クラスタ数をどの程度にすれば適切に分割されるかを事前に予想することが難しい場合は、分割ポイントの閾値を設定して実行する方法を使用すると、ある程度適切な分割が完了するまで分割をしてくれます。入力データにもよりますが、ポイントは1.0〜2.0程度を指定するとよいです。

{{{
% bayon -l 1.0 input.tsv > output.tsv (分割ポイントの閾値が1.0を下回るまで分割)
}}}

=== クラスタリング手法を変える場合 ===

クラスタリング手法はデフォルトの設定ではrb(Repeated Bisection法)を使用します。K-meansを使用してクラスタリングを行いたい場合は、以下のようにクラスタリング手法を指定して実行してください。

{{{
% bayon -n 100 input.tsv -m kmeans (100個のクラスタに分割する場合)
}}}

通常使用する場合は、kmeansと比べてrbの方が高速でかつ精度もよいため、rbのまま実行することをおすすめします。

== 入力データのフォーマット ==

入力データは、以下のようにタブ区切りのフォーマットのテキストファイルにしてください。1行に1つのドキュメントの情報を記入し、空行は含めないようにしてください。各行は先頭にそのドキュメントのIDを記入し、IDの後はそのドキュメントの特徴を表すキーとそのポイントを記入してください。キーとポイントのペアは複数記入できますが、必ずペアで入力する必要があります。

{{{
document_id1 \t key1-1 \t value1-1 \t key1-2 \t value1-2 \t ...\n
document_id2 \t key2-1 \t value2-1 \t key2-2 \t value2-2 \t ...\n
...
}}}

各フィールドは以下を表しています。

 * _document_id_ 各ドキュメントのIDで、ドキュメント毎にユニークである必要があります。タブを含まない任意の文字列を使用できます。
 * _key_: ドキュメントの特徴を表す文字列です。タブを含まない任意の文字列が使用できます。
 * _value_: keyの特徴の度合いを表し、この値が高いほどより特徴的なフレーズになります。実数が使用できます。

valueは特徴の度合いを正しく反映している必要があります。そのため、例えば文書集合のクラスタリングを行う場合等では、単に単語の頻度を使うのではなく、[http://ja.wikipedia.org/wiki/Tf-idf tf-idf]などを使用して、より適切にポイントづけを行うことで、クラスタリングの精度を上げることができます。

=== 入力データの例 ===

特徴として、よく聞く音楽のジャンルを使った入力例を示します。

{{{
阿佐田   J-POP       10   J-R&B       6   ロック  4
小島     ジャズ       8   レゲエ      9
古川     クラシック   4   ワールド    4
田村        ジャズ       9   メタル      2   レゲエ  6
E        J-POP        4   ロック      3   HIPHOP  3
F        クラシック   8   ロック      1
}}}

上記の例では「阿佐田」「小島」「古川」が各ドキュメントのID(人名)を表し、「阿佐田」の特徴を表すフレーズ(音楽のジャンル)として「J-POP」「J-R&B」「ロック」が挙げられています。

== 出力データのフォーマット ==

出力データは、以下のようなタブ区切りのフォーマットのテキストになります。1行が1つのクラスタを表し、先頭がクラスタのID、それ以降はそのクラスタに所属するドキュメントのIDをタブ区切りでつなげたリストになります。

{{{
cluster_id1 \t document_id1 \t document_id2 \t document_id3 \t ...\n
cluster_id2 \t document_id4 \t document_id5 \t document_id6 \t ...\n
...
}}}

= クラスタリング手法の説明 =

== Repeated Bisection ==

Repeated Bisection法は[http://glaros.dtc.umn.edu/gkhome/views/cluto CLUTO]というクラスタリングツールで使用されているクラスタリングアルゴリズムで、データセットを繰り返し2分割することでクラスタリングを行います。また分割の際、2分割されたクラスタ間でデータの移動の行うことで、クラスタの精度向上を行っています。K-means法などと比較して、高速に実行でき、また精度も良好なようです。より詳しく説明しますと、 Repeated Bisectionは以下の1-5の処理を実行し、繰り返しクラスタを2分割していくことでクラスタリンを行います。


 # 分割するクラスタを1つ選択する
 # クラスタ中からランダムに2つ要素を選択し、それぞれが格納したクラスタを2つ作成する
 # 元のクラスタ中の全ての要素に対し、2で選んだ要素との類似度を求め、類似度が高い方のクラスタに要素を追加する
 # 2クラスタ間で要素の移動を行い、分割結果の洗練を行う(移動できる要素がなくなるまで続ける)
 # 1に戻り、指定されたクラスタ数に分割されるまで繰り返す

[http://mahjong-mania.net/bayon/img/rb.png]

ここで、2-4のプロセスだけに注目してみると、これはクラスタの中心を2つとしてK-means法を実行しているのと同じことをしています。つまりRepeated BisectionはK-meansを繰り返し実行しているだけなのです。 

詳しくは[http://glaros.dtc.umn.edu/gkhome/views/cluto CLUTO]のサイトから論文を参照してください。

== K-means ==

K-meansについては、Wikipediaの[http://ja.wikipedia.org/wiki/K-means%E6%B3%95 K-means法のページ]など、説明をしているwebページがたくさんあるのでそちらをご参照下さい。